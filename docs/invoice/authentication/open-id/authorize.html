<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-invoice/authentication/open-id/authorize">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Authorize | MobilePay Developer</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://developer.mobilepay.dk/docs/invoice/authentication/open-id/authorize"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Authorize | MobilePay Developer"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://developer.mobilepay.dk/docs/invoice/authentication/open-id/authorize"><link data-rh="true" rel="alternate" href="https://developer.mobilepay.dk/docs/invoice/authentication/open-id/authorize" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer.mobilepay.dk/docs/invoice/authentication/open-id/authorize" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-206187508-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.13a7decd.css">
<link rel="preload" href="/assets/js/runtime~main.0e051022.js" as="script">
<link rel="preload" href="/assets/js/main.a5bde6c7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-blue.svg" alt="MobilePay" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-white.svg" alt="MobilePay" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Developer</b></a><a class="navbar__item navbar__link" href="/docs/app-payments">App Payments</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/invoice">Invoice</a><a class="navbar__item navbar__link" href="/docs/online">Online</a><a class="navbar__item navbar__link" href="/docs/pos">Point of Sale</a><a class="navbar__item navbar__link" href="/docs/subscriptions">Subscriptions</a><a class="navbar__item navbar__link" href="/docs/reporting">Reporting</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">API references</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/api/app-payments">App payments</a></li><li><a class="dropdown__link" href="/api/wehooks">Webhooks</a></li><li><a class="dropdown__link" href="/api/invoice">Invoice</a></li><li><a class="dropdown__link" href="/api/online">Online</a></li><li><a class="dropdown__link" href="/api/pos">PoS</a></li><li><a class="dropdown__link" href="/api/subscriptions">Subscriptions</a></li><li><a class="dropdown__link" href="/api/reporting">Reporting (v3)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/support">Support</a><a href="https://github.com/MobilePayDev/MobilePayDev.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/app-payments">App Payments</a><button aria-label="Toggle the collapsible sidebar category &#x27;App Payments&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/invoice">Invoice</a><button aria-label="Toggle the collapsible sidebar category &#x27;Invoice&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/invoice/development-guide/getting-started">Development Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/invoice/authentication">Authentication</a><button aria-label="Toggle the collapsible sidebar category &#x27;Authentication&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/invoice/authentication/open-id">OAuth Access token</a><button aria-label="Toggle the collapsible sidebar category &#x27;OAuth Access token&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/invoice/authentication/open-id/authorize">Authorize</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/authentication/open-id/code">Get code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/authentication/open-id/tokens">Tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/authentication/open-id/refresh-tokens">Refresh tokens</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/invoice-issuers">Invoice Issuers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/api-endpoint-reference">API Endpoint Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/callbacks">Callbacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/notifications">Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/visual-examples">Visual examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/release-note">Release Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/invoice/resources">Resources</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/online">Online</a><button aria-label="Toggle the collapsible sidebar category &#x27;Online&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/pos">Point of Sale</a><button aria-label="Toggle the collapsible sidebar category &#x27;Point of Sale&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/subscriptions">Subscriptions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Subscriptions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reporting">Reporting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reporting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/support">Developer Support</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Support&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/invoice"><span itemprop="name">Invoice</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/invoice/authentication"><span itemprop="name">Authentication</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/invoice/authentication/open-id"><span itemprop="name">OAuth Access token</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Authorize</span><meta itemprop="position" content="4"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>Authorize</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-initiate-consent">Step 1: Initiate consent<a class="hash-link" href="#step-1-initiate-consent" title="Direct link to heading">​</a></h2><p>The 1st step is forming an authorization request with the appropriate URI parameters at the authorization endpoint</p><p>You can find detailed information about this request in the OpenID Connect specification <a href="http://openid.net/specs/openid-connect-core-1_0.html#AuthRequest" target="_blank" rel="noopener noreferrer">here</a>
Specification of parameters are found <a href="http://openid.net/specs/openid-connect-core-1_0.html#HybridAuthRequest" target="_blank" rel="noopener noreferrer">here</a> </p><ul><li>Sandbox Authorization Endpoint DK: <a href="https://sandprod-admin.mobilepay.dk/account/connect/authorize" target="_blank" rel="noopener noreferrer">https://sandprod-admin.mobilepay.dk/account/connect/authorize</a></li><li>Sandbox Authorization Endpoint FI: <a href="https://sandprod-admin.mobilepay.fi/account/connect/authorize" target="_blank" rel="noopener noreferrer">https://sandprod-admin.mobilepay.fi/account/connect/authorize</a></li><li>Production Authorization Endpoint DK: <a href="https://admin.mobilepay.dk/account/connect/authorize" target="_blank" rel="noopener noreferrer">https://admin.mobilepay.dk/account/connect/authorize</a></li><li>Production Authorization Endpoint FI: <a href="https://admin.mobilepay.fi/account/connect/authorize" target="_blank" rel="noopener noreferrer">https://admin.mobilepay.fi/account/connect/authorize</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="openid-connect-discovery">OpenID Connect Discovery<a class="hash-link" href="#openid-connect-discovery" title="Direct link to heading">​</a></h2><ul><li>The OpenID Connect protocol requires the use of multiple endpoints for authenticating users, and for requesting resources including tokens. </li><li>To simplify implementations and increase simplicity, OIDC allows the use of a &quot;Discovery document&quot; <a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer">OpenID Connect Discovery</a>, where an OpenID server publishes its metadata at a well-known URL, typically
<code>https://admin.mobilepay.dk/account/.well-known/openid-configuration</code></li><li>This URL returns a JSON listing of the OpenID/OAuth endpoints, supported scopes and claims, public keys used to sign the tokens, and other details. The clients can use this information to construct a request to the OpenID server. The field names and values are defined in the <a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer">OpenID Connect Discovery Specification</a>.</li><li>Find the links for the discovery document below. It will be used by you to download the necessary configuration data.  This should not be attempted without a solid grasp of the OAuth2 and Open ID Connect standards. All endpoints needed for integration can be found in our openid connect discovery endpoint. These endpoints should be fetched dynamically by your application, since they are prone for change.</li><li>The metadata is a simple JavaScript Object Notation (JSON) document.  </li></ul><p>Here is an example of data returned:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;issuer&quot;: &quot;https://api.mobilepay.dk/merchant&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;jwks_uri&quot;: &quot;https://api.mobilepay.dk/merchant-authentication-openidconnect/.well-known/openid-configuration/jwks&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;authorization_endpoint&quot;:&quot;https://admin.mobilepay.dk/account/connect/authorize&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;token_endpoint&quot;:&quot;https://api.mobilepay.dk/merchant-authentication-openidconnect/connect/token&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;end_session_endpoint&quot;:&quot;https://admin.mobilepay.dk/account/connect/endsession&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;introspection_endpoint&quot;:&quot;https://api.mobilepay.dk/merchant-authentication-openidconnect/connect/introspect&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;frontchannel_logout_supported&quot;:true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;frontchannel_logout_session_supported&quot;:true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="openid-connect-discovery-1">OpenID Connect Discovery<a class="hash-link" href="#openid-connect-discovery-1" title="Direct link to heading">​</a></h3><table><thead><tr><th>Environment</th><th>Link to configuration data</th></tr></thead><tbody><tr><td>Sandbox</td><td><a href="https://sandprod-admin.mobilepay.dk/account/.well-known/openid-configuration" target="_blank" rel="noopener noreferrer">Denmark</a> - <a href="https://sandprod-admin.mobilepay.fi/account/.well-known/openid-configuration" target="_blank" rel="noopener noreferrer">Finland</a></td></tr><tr><td>Production</td><td><a href="https://admin.mobilepay.dk/account/.well-known/openid-configuration" target="_blank" rel="noopener noreferrer">Denmark</a> - <a href="https://admin.mobilepay.fi/account/.well-known/openid-configuration" target="_blank" rel="noopener noreferrer">Finland</a></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="call-authorize-to-initiate-user-login-and-consent">Call /authorize to initiate user login and consent<a class="hash-link" href="#call-authorize-to-initiate-user-login-and-consent" title="Direct link to heading">​</a></h2><p>Before a client can access a protected resource, it must first obtain an authorization grant from the resource owner, and then exchange the authorization grant for an access token. You should retrieve the base URI from the Discovery document using the authorization endpoint. The next step is forming an authorization request with the appropriate URI parameters at the authorization endpoint, which can be done by <code>HTTP GET</code> - using query string serialization as described <a href="http://openid.net/specs/openid-connect-core-1_0.html#QuerySerialization" target="_blank" rel="noopener noreferrer">here</a></p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Sample raw request using GET</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET https</span><span class="token operator" style="color:#393A34">:</span><span class="token comment" style="color:#999988;font-style:italic">//sandprod-admin.mobilepay.dk/account/connect/authorize</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;response_type=code%20id_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;response_mode=form_post</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;client_id=some.test.client.usually.your.company.name.in.small.letters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;redirect_uri=https%3A%2F%2Fmyredirect%40uri.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;scope=openid%20invoice%20subscriptions%20offline_access%20transactionreporting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;state=228eaa0b1a2819a77f055171edb7d9d6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;code_challenge=Ge5p0wzlM_2SrxcCy9WAplP_CupB2xu2uiwFq_BBUmY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;code_challenge_method=S256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;nonce=28b32545bee64100a6e92eddbc13f562</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;merchant_vat=DK12345678</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-of-mandatory-parameters">Explanation of mandatory parameters<a class="hash-link" href="#explanation-of-mandatory-parameters" title="Direct link to heading">​</a></h3><table><thead><tr><th>Parameters</th><th>Description</th><th>Value</th><th>Required</th></tr></thead><tbody><tr><td><code>response_type</code></td><td>OAuth 2.0 Response Type value that determines the authorization processing flow to be used, including what parameters are returned from the endpoints used.</td><td><code>code id_token</code></td><td>Yes</td></tr><tr><td><code>response_mode</code></td><td><code>form_post</code> sends the token response as a form post instead of a fragment encoded redirect . In this mode, Authorization Response parameters are encoded as HTML form values that are auto-submitted in the User Agent, and thus are transmitted via the HTTP POST method to the Client, with the result parameters being encoded in the body using the application/x-www-form-urlencoded format. <code>fragment</code> - Parameters are encoded in the URL fragment added to the redirect_uri when redirecting back to the client.</td><td><code>form_post</code> or <code>fragment</code></td><td>Yes</td></tr><tr><td><code>client_id</code></td><td>The client_id that you received by zip file. This is not the same as the MerchantID or the e-mail log-in to <a href="https://sandprod-admin.mobilepay.dk" target="_blank" rel="noopener noreferrer">https://sandprod-admin.mobilepay.dk</a></td><td>Customer redirect uri as registered by <a href="mailto:developer@mobilepay.dk" target="_blank" rel="noopener noreferrer">developer@mobilepay.dk</a></td><td>Yes</td></tr><tr><td><code>scope</code></td><td>A space list of scopes. For this flow, the full list of possible scopes is <code>openid offline_access subscriptions invoice transactionreporting merchantpayments webhooks</code>. The scopes <code>openid offline_access</code> is required, the rest is product specific. It is a space-separated list.</td><td><em>openid offline_access subscriptions invoice transactionreporting merchantpayments webhooks</em></td><td>Yes</td></tr><tr><td><code>state</code></td><td>State is used to maintain state between the request and the callback. You generate a new value for each request, and we return it in response for you to validate.</td><td>Unique random value</td><td>Yes</td></tr><tr><td><code>code_challenge</code></td><td>A challenge for PKCE. The challenge is verified in the access token request, it will be used in combination with the next call. Read more <a href="https://auth0.com/docs/api-auth/tutorials/authorization-code-grant-pkce#2-create-a-code-challenge" target="_blank" rel="noopener noreferrer">here</a></td><td>The value should be a SHA-256 hash of a crypto random byte array.</td><td>Yes</td></tr><tr><td><code>code_challenge_method</code></td><td>The method that was used to derive code challenge.</td><td>S256</td><td>Yes</td></tr><tr><td><code>nonce</code></td><td>String value used to associate a client session with an ID Token, and to mitigate replay attacks. The value is passed through unmodified from the authentication request to the ID Token. Sufficient entropy must be present in the nonce values used to prevent attackers from guessing values. Should be a new random value for each request. We invalidate a nonce once our back-end has received it, so next time we get a request with the same nonce, we then reject it. Read more <a href="http://openid.net/specs/openid-connect-core-1_0.html#NonceNotes" target="_blank" rel="noopener noreferrer">here</a></td><td>Unique random value</td><td>Yes</td></tr><tr><td><code>merchant_vat</code></td><td>A string value equal to the VAT number for the merchant. This is used to identify which merchant that should be given consent to if a user has multiple merchants assigned. We support FI and DK VAT numbers. The VAT number consists of country prefix (either FI or DK) and 8 digits. Note: merchant_vat is required when granting consent to a specific merchant</td><td>Country prefix + VAT number of merchant</td><td>Yes</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>By using the value that you used when creating the <code>code_challenge</code>, we have a way for MobilePay to verify the call. You execute the Authorization call once, and you also make the <code>code_challenge</code> once with one <code>code_verifier</code>. But you need to save your <code>code_verifier</code> so you can use it every time you utilize your <code>refresh_token</code>. This means that you’ll not need to go through the Authorize call again, but that you simply need to utilize the <code>code_verifier</code> from the the original authorization call. </p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="consent-screen">Consent screen<a class="hash-link" href="#consent-screen" title="Direct link to heading">​</a></h3><p>When the Merchant is logged in, the MobilePay Portal presents the Merchant with a consent screen that describes the information that the Merchant is granting to. For example, when the user wants to have MobilePay Subscriptions, the consent screen asks to give access to Subscriptions. The request access to this information using the scope parameter which you include in the authorize request. You can also use scopes to request access to other MobilePay API&#x27;s. When the Merchant clicks yes (gives consent), the Merchant is redirected back to the integrators website/environment).</p><p>Integrator has been provided with a test merchant to our <a href="https://sandprod-admin.mobilepay.dk/" target="_blank" rel="noopener noreferrer">MobilePay Portal - Sandbox</a>. Integrator should use the e-mail and password provided in the invitational e-mail to log-on to it.</p><p><img loading="lazy" alt="Sandprod admin screen" src="/assets/images/oidc-sandprod_admin_screen_testmerchant-ec437be361efd9909e53aca7f5227645.png" width="1754" height="813" class="img_ev3q"></p><img loading="lazy" src="/assets/images/oidc-consent_screen-d8ad84a657350fa124b273a6dd7d263f.png" alt="PoS confirmation screen" width="700" class="img_ev3q"><p>Once the user authenticates successfully, the application will be redirected to the redirect_uri, with a code as part of the URL: <code>https://redirect_url#code=xxx</code> You can exchange this code with an Access Token using the token endpoint <code>https://api.sandbox.mobilepay.dk/merchant-authentication-openidconnect/connect/token</code> </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unauthorized-and-error-response">Unauthorized and error response<a class="hash-link" href="#unauthorized-and-error-response" title="Direct link to heading">​</a></h3><p>You might see this page when trying to obtain an <code>authorization_code</code>. If you see this page, it is most often due to an invalid request. The request is missing a required parameter, includes an invalid parameter value or a redirect_uri, that hasn&#x27;t been whitelisted. MobilePay does not provide additional information, used to assist the client developer with additional information about the error, in order to mitigate against cross-site request forgery. <strong>Ensure that all required parameters are present and valid.</strong> </p><p><img loading="lazy" alt="Sandprod consent screen" src="/assets/images/oidc-unauthorized-a6d282dc69328f8b7b9b870791bd2135.jpg" width="1236" height="587" class="img_ev3q"></p><table><thead><tr><th>Error</th><th>Description</th></tr></thead><tbody><tr><td>invalid_client</td><td>Client authentication failed, such as if the request contains an invalid client ID or secret.</td></tr><tr><td>unauthorized_client</td><td>This client is not authorized to use the requested grant type.</td></tr><tr><td>invalid_grant</td><td>The authorization code is invalid or expired. This is also the error you would return if the redirect URL given in the authorization grant does not match the URL provided in this access token request.</td></tr><tr><td>invalid_scope</td><td>This error indicates an invalid scope value in the request</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/invoice/authentication/open-id"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">OpenId Flow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/invoice/authentication/open-id/code"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Get code</div></a></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 MobilePay. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0e051022.js"></script>
<script src="/assets/js/main.a5bde6c7.js"></script>
</body>
</html>