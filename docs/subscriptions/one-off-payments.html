<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-subscriptions/one-off-payments" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">One-off Payments | MobilePay Developer</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://developer.mobilepay.dk/docs/subscriptions/one-off-payments"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="One-off Payments | MobilePay Developer"><meta data-rh="true" name="description" content="There are 3 flows a customer can pay for a product or a service with One-Off payments."><meta data-rh="true" property="og:description" content="There are 3 flows a customer can pay for a product or a service with One-Off payments."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://developer.mobilepay.dk/docs/subscriptions/one-off-payments"><link data-rh="true" rel="alternate" href="https://developer.mobilepay.dk/docs/subscriptions/one-off-payments" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer.mobilepay.dk/docs/subscriptions/one-off-payments" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-206187508-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.913a1e15.css">
<link rel="preload" href="/assets/js/runtime~main.92d7fe27.js" as="script">
<link rel="preload" href="/assets/js/main.7b80158d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-blue.svg" alt="MobilePay" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-white.svg" alt="MobilePay" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Developer</b></a><a class="navbar__item navbar__link" href="/docs/app-payments">App Payments</a><a class="navbar__item navbar__link" href="/docs/invoice">Invoice</a><a class="navbar__item navbar__link" href="/docs/online">Online</a><a class="navbar__item navbar__link" href="/docs/pos">Point of Sale</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/subscriptions">Subscriptions</a><a class="navbar__item navbar__link" href="/docs/reporting">Reporting</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">API references</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/api/app-payments">App payments</a></li><li><a class="dropdown__link" href="/api/wehooks">Webhooks</a></li><li><a class="dropdown__link" href="/api/invoice">Invoice</a></li><li><a class="dropdown__link" href="/api/online">Online</a></li><li><a class="dropdown__link" href="/api/pos">PoS</a></li><li><a class="dropdown__link" href="/api/subscriptions">Subscriptions</a></li><li><a class="dropdown__link" href="/api/reporting">Reporting (v3)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/support">Support</a><a href="https://github.com/MobilePayDev/MobilePayDev.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/app-payments">App Payments</a><button aria-label="Toggle the collapsible sidebar category &#x27;App Payments&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/invoice">Invoice</a><button aria-label="Toggle the collapsible sidebar category &#x27;Invoice&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/online">Online</a><button aria-label="Toggle the collapsible sidebar category &#x27;Online&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/pos">Point of Sale</a><button aria-label="Toggle the collapsible sidebar category &#x27;Point of Sale&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/subscriptions">Subscriptions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Subscriptions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/subscriptions/development-guide">Development Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/subscriptions/authentication">Authentication</a><button aria-label="Toggle the collapsible sidebar category &#x27;Authentication&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/general-notes">General notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/subscriptions-providers">Subscriptions Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/agreement">Agreements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/subscriptions-payments">Subscriptions Payments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/subscriptions/one-off-payments">One-off Payments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/refund">Refund</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/invoice">Invoice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/release-notes">Release Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/glossary">Glossary of Terms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/api-principles">API principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/transition-to-one-platform">💙🧡 Preparation for facade period</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/resources">Migration info 🔗</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reporting">Reporting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reporting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/support">Developer Support</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Support&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/subscriptions"><span itemprop="name">Subscriptions</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">One-off Payments</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>One-off Payments</h1><p>There are 3 flows a customer can pay for a product or a service with One-Off payments.
You are able to:</p><ul><li><a href="#flow-1--one-off-payment-with-a-new-agreement">Flow 1</a>: Create a new Agreement with an initial One-Off Payment.</li><li><a href="#flow-2---one-off-payment-on-an-existing-agreement">Flow 2</a>: Customer can initiate and request arbitrary One-Off Payment payments on their existing Agreement.</li><li><a href="#flow-3---one-off-with-auto-reserve">Flow 3</a>: Merchants can send a One-Off payment, which MobilePay will attempt to automatically reserve, without the user’s confirmation</li></ul><p>Note: One-off payments are charged when the customer manually swipes accept or <code>auto_reserve</code> field was set to <strong>true</strong> when a one-off payment was requested.  </p><p><strong>One-off Payment</strong> will expire in 1 day (by default) if it is not accepted or rejected by the user during that time or automatic reservation failed and user didn&#x27;t take any action afterward. The Merchant (or the integrator) will receive a callback when the One-Off Payment is expired.
Custom expiration times ranging from 1 minute to 18 weeks can be specified by providing <code>expiration_timeout_minutes</code> field.
Note: as an integrator, it is your responsibility to align with the Merchant on needs for the fields, since the default expiration of 1 day does not suit all Merchant use cases.</p><p>Payment reservation appears on the user&#x27;s Activities List in the &#x27;Pending&#x27; section in the MobilePay app. When the purchase is completed, the transaction is moved to the &#x27;Approved&#x27; section in the MobilePay app.</p><p>One-off payment does not affect the frequency and grace period. So if you create an agreement with a one-off payment, you can request the first subscription payment whenever you want. You can also request a one-off payment on an existing agreement in between two subscription payments, and it will not be affected by the frequency.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flow-1--one-off-payment-with-a-new-agreement">Flow 1- One-off Payment With a New Agreement<a href="#flow-1--one-off-payment-with-a-new-agreement" class="hash-link" aria-label="Direct link to Flow 1- One-off Payment With a New Agreement" title="Direct link to Flow 1- One-off Payment With a New Agreement">​</a></h2><ul><li>Use this when the customer does not have an agreement already, and you need the customer to create an agreement and simultaneously pay for the service/product. This allows for products to be bundled with agreements as one transaction (for example a phone).  </li><li>When you create an agreement with a One-Off payment, and the user accepts the agreement, the payment will be created and reserved.</li><li>Capture and Reserve is handled by the Merchant. Capture is done even if the user is blocked after reservation. When the one-off payment is processed, the payment will show up in the users&#x27;s activity list in the MobilePay app.</li></ul><p>Add a <code>one_off_payment</code> property to the <code>POST /api/providers/{providerId}/agreements</code> request payload if you want the agreement activated only when the user is successfully charged an initial subscription amount.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;external_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AGGR00068&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;amount&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;currency&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DKK&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Monthly subscription&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;frequency&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;links&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user-redirect&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;success-callback&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cancel-callback&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;country_code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DK&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;plan&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Basic&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expiration_timeout_minutes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;mobile_phone_number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4511100118&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;one_off_payment&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;amount&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;80&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;external_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OOP00348&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Down payment for our services&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;expiration_timeout_minutes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1440&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Request parameters</strong></p><table><thead><tr><th align="left">Parameter</th><th align="left">Type</th><th align="left">Required</th><th align="left">Description</th><th align="left">Valid values</th></tr></thead><tbody><tr><td align="left"><strong>one_off_payment</strong></td><td align="left">object</td><td align="left"></td><td align="left"><em><strong>One-Off Payment</strong> details.</em></td><td align="left"></td></tr><tr><td align="left"><strong>one_off_payment.amount</strong></td><td align="left">number(0.00)</td><td align="left">required</td><td align="left"><em><strong>One-Off Payment</strong> amount, which will be displayed for the user in the MobilePay app.</em></td><td align="left">&gt; 0.00, decimals separated with a dot.</td></tr><tr><td align="left"><strong>one_off_payment.description</strong></td><td align="left">string(60)</td><td align="left">required</td><td align="left"><em>Additional information provided by the merchant to the user, that will be displayed on the <strong>One-off Payment</strong> screen. Description is a short description of what the client is paying for.</em></td><td align="left"></td></tr><tr><td align="left"><strong>one_off_payment.external_id</strong></td><td align="left">string(64)</td><td align="left">required</td><td align="left"><em><strong>One-Off Payment</strong> identifier on the merchant&#x27;s side. This will be included in the request body of the payment callback. The external_id is visible on the <strong>One-off Payment</strong> screen.</em></td><td align="left"></td></tr><tr><td align="left"><strong>one_off_payment.expiration_timeout_minutes</strong></td><td align="left">int</td><td align="left">optional</td><td align="left"><em><strong>One-Off Payment</strong> expiration timeout in minutes.</em></td><td align="left">Min: 1, max: 181440 (18 weeks), default: 1440 (24 hours)</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The recommendation for &quot;external_id&quot; is to use up to 30 symbols. For instant transfers &quot;external_id&quot; is used as the payment reference and will be truncated down to 30 symbols if it contains more. Truncated payment reference will be visible in the bank statement.</p></div></div><p>In this case, the response of <code>POST /api/providers/{providerId}/agreements</code> will contain an additional <code>one_off_payment_id</code> value - id of the newly requested <strong>One-Off Payment</strong>.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;one_off_payment_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2a5dd31f-32c1-4517-925f-9c60ba19f8ca&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;links&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mobile-pay&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://&lt;mobile-pay-landing-page&gt;/?flow=agreement&amp;id=1b08e244-4aea-4988-99d6-1bd22c6a5b2c&amp;redirectUrl=https%3a%2f%2fwww.example.com%2fredirect&amp;countryCode=DK&amp;mobile=4511100118&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flow-2---one-off-payment-on-an-existing-agreement">Flow 2 - One-off Payment on an Existing Agreement<a href="#flow-2---one-off-payment-on-an-existing-agreement" class="hash-link" aria-label="Direct link to Flow 2 - One-off Payment on an Existing Agreement" title="Direct link to Flow 2 - One-off Payment on an Existing Agreement">​</a></h2><p>Use a <code>POST /api/providers/{providerId}/agreements/{agreementId}/oneoffpayments</code> endpoint in order to charge your customer one time for extra services.  </p><ul><li>Use case: When the customer already has an active agreement and wants to order extra services/products. It is customer-initiated, and the customer needs to swipe in the MobilePay app. It is not possible to capture expired payments.  </li><li>Capture and Reserve is handled by the Merchant. The Merchant needs to capture the payment, to avoid that the payment will end up as being expired. It is dependent on the merchant&#x27;s use case, and how fast the Merchant wants to capture the One-Off payment. For example, a hotel may reserve a payment, then move the money when the guest checks out.</li><li>Merchant uses Agreement ID to make the payment request, not the phone number.</li></ul><p>The response of <code>POST /api/providers/{providerId}/agreements/{agreementId}/oneoffpayments</code> contains two values: a unique <em>id</em> of the newly requested <strong>One-Off Payment</strong> and a link <em>rel</em> = <em>mobile-pay</em>.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;07b70fdd-a300-460d-9ba1-aee2c8bb4b63&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;links&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mobile-pay&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://&lt;mobile-pay-landing-page&gt;/?flow=agreement&amp;id=1b08e244-4aea-4988-99d6-1bd22c6a5b2c&amp;oneOffPaymentId=07b70fdd-a300-460d-9ba1-aee2c8bb4b63&amp;redirectUrl=https%3a%2f%2fwww.example.com%2fredirect&amp;countryCode=DK&amp;mobile=4511100118&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The <em>id</em> value can be used on the merchant&#x27;s back-end system to map a one-off payment with a specific Subscription agreement on the merchant&#x27;s side, and subsequently to capture a requested <strong>One-Off Payment</strong> when the MobilePay user accepts it.</li><li>The link <em>rel = mobile-pay</em> hyperlink reference must be used to redirect the user automatically using an HTTP response 302 or 303. Once the user is redirected, the MobilePay app will be opened to confirm the <strong>One-off Payment</strong>. This applies only if the <code>auto_reserve</code> field is omitted or set to <strong>false</strong>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flow-3---one-off-with-auto-reserve">Flow 3 - One-off with Auto reserve<a href="#flow-3---one-off-with-auto-reserve" class="hash-link" aria-label="Direct link to Flow 3 - One-off with Auto reserve" title="Direct link to Flow 3 - One-off with Auto reserve">​</a></h2><ul><li>The one-off payment without swipe is sent directly to the MobilePay app. There is no MobilePay landing page. If the payment is successful, then a push message is shown that the One-off without swipe/confirmation was successful.</li><li>One-Off without swipe is valid for One-Offs without a new agreement.</li></ul><p>When using one-off without a swipe, the sliding part is omitted. There might still be issues with the card, nemID, and the user will get a push message about the failed payment. But until then, it is  a reserved payment. Therefore, there is a possibility of a time gap.  </p><ul><li>Merchants can send one-off payment, which MobilePay will attempt to automatically reserve, without the user’s confirmation.</li><li><strong>Value</strong>: The customer does not need to swipe and the payment experience is seamless</li></ul><p>Merchants who want to use  <code>auto_reserve</code> field  feature, must apply for this in regards to the onboarding of Subscriptions. Merchants cannot use this feature without being pre-approved to do so.</p><p><strong>Request parameters</strong></p><table><thead><tr><th align="left">Parameter</th><th align="left">Type</th><th align="left">Required</th><th align="left">Description</th><th align="left">Valid values</th></tr></thead><tbody><tr><td align="left"><strong>amount</strong></td><td align="left">number(0.00)</td><td align="left">required</td><td align="left"><em><strong>One-off Payment</strong> amount, which will be displayed for the user in the MobilePay app.</em></td><td align="left">&gt; 0.00, decimals separated with a dot.</td></tr><tr><td align="left"><strong>description</strong></td><td align="left">string(60)</td><td align="left">required</td><td align="left"><em>Additional information provided by the merchant to the user, that will be displayed on the <strong>One-off Payment</strong> screen.</em></td><td align="left"></td></tr><tr><td align="left"><strong>external_id</strong></td><td align="left">string(64)</td><td align="left">required</td><td align="left"><em><strong>One-off Payment</strong> identifier on the merchant&#x27;s side. This will be included in the request body of the payment callback. The external_id is visible on the <strong>One-off Payment</strong> screen.</em></td><td align="left"></td></tr><tr><td align="left"><strong>links</strong></td><td align="left">string</td><td align="left">required</td><td align="left"><em>Link relation of the <strong>One-off Payment</strong> creation sequence. Must contain 1 value for user redirect.</em></td><td align="left"></td></tr><tr><td align="left"><strong>links[].rel</strong></td><td align="left">string</td><td align="left">required</td><td align="left"><em>Link relation type.</em></td><td align="left">user-redirect</td></tr><tr><td align="left"><strong>links[].href</strong></td><td align="left">string</td><td align="left">required</td><td align="left"><em>Link relation hyperlink reference.</em></td><td align="left">merchant url</td></tr><tr><td align="left"><strong>auto_reserve</strong></td><td align="left">boolean</td><td align="left">optional</td><td align="left"><em>When this field is set to <strong>true</strong>, we will attempt to automatically reserve the payment without the user&#x27;s interaction. If you do not wish payment to be automatically reserved, you can omit this field or set it to <strong>false</strong>.</em></td><td align="left">true/false</td></tr><tr><td align="left"><strong>expiration_timeout_minutes</strong></td><td align="left">int</td><td align="left">optional</td><td align="left"><em><strong>One-Off Payment</strong> expiration timeout in minutes.</em></td><td align="left">Min: 1, max: 181440 (18 weeks), default: 1440 (24 hours)</td></tr></tbody></table><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;amount&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;80&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;external_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OOP00348&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Pay now for additional goods&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;links&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user-redirect&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;auto_reserve&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expiration_timeout_minutes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1440&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The recommendation for &quot;external_id&quot; is to use up to 30 symbols. For instant transfers &quot;external_id&quot; is used as the payment reference and will be truncated down to 30 symbols if it contains more. Truncated payment reference will be visible in the bank statement.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-off-payment-screens">One-off payment screens<a href="#one-off-payment-screens" class="hash-link" aria-label="Direct link to One-off payment screens" title="Direct link to One-off payment screens">​</a></h2><p><a target="_blank" href="/assets/files/subs-One-off-flows-91c3ab4084113c3622395bfd652b7d91.svg"><img loading="lazy" alt="OneOff flows" src="/assets/images/subs-One-off-flows-91c3ab4084113c3622395bfd652b7d91.svg" width="2000" height="1531" class="img_ev3q"></a></p><p>When <code>auto_reserve</code> field is set to <strong>true</strong>:</p><p><a target="_blank" href="/assets/files/subs-One-off-flows-without-swipe-df7140b17de301bc295d9adbdae0d236.svg"><img loading="lazy" alt="OneOff without swipe" src="/assets/images/subs-One-off-flows-without-swipe-df7140b17de301bc295d9adbdae0d236.svg" width="1999" height="1459" class="img_ev3q"></a></p><ul><li><p>Failed <code>auto_reserve</code> OneOff: If the payment fails, and if push messages are also turned off, then a one-off confirmation screen after logging in (until the session expires) is displayed for the User. The user can retry the payment from the  Confirmation screen.</p></li><li><p>Successful <code>auto_reserve</code> OneOff: If the payment is successful, then the user is presented with a reservation receipt.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dual-device">Dual Device<a href="#dual-device" class="hash-link" aria-label="Direct link to Dual Device" title="Direct link to Dual Device">​</a></h2><p>Initiating a purchase of a product/service from a desktop (the other device) should end-up as</p><ul><li>one-off Payment Landing Page on Desktop and</li><li>a push directly to MobilePay (push notification)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="callbacks">Callbacks<a href="#callbacks" class="hash-link" aria-label="Direct link to Callbacks" title="Direct link to Callbacks">​</a></h2><p>Once the one-off payment status changes from <em>Requested</em> to <em>Reserved</em>, <em>Rejected</em> or <em>Expired</em>, a callback will be done to the callback address, which is configurable via <code>PATCH /api/providers/{providerId}</code> with path value <code>/payment_status_callback_url</code>. The same way as with <a href="/docs/subscriptions/subscriptions-payments#callbacks">callbacks</a> for regular payment requests.</p><table><thead><tr><th>New Status</th><th>Condition</th><th>When to expect</th><th>Callback <em>status</em></th><th>Callback <em>status_text</em></th><th>Callback <em>status_code</em></th></tr></thead><tbody><tr><td>Reserved</td><td><em>The one-off payment was accepted by the user or was automatically reserved with <code>auto_reserve</code> flag and money is reserved for you on his card. You can now capture the money.</em></td><td>Right after payment was successfully reserved.</td><td>Reserved</td><td>Payment successfully reserved.</td><td>0</td></tr><tr><td>Rejected</td><td><em>User rejected one-off payment request in MobilePay.</em></td><td>Right after user rejects one-off payment.</td><td>Rejected</td><td>Rejected by user.</td><td>50001</td></tr><tr><td>Expired</td><td><em>1. One-off payment was neither accepted, nor rejected by user. 2. User didn&#x27;t any action after the automatic reservation failed.</em></td><td>1 day after you requested one-off payment</td><td>Expired</td><td>Expired by the system.</td><td>50008</td></tr><tr><td>Requested</td><td><em>The automatic reservation of a one-off payment failed. User action is needed.</em></td><td>Right after the automatic reservation has failed</td><td>Requested</td><td>Automatic reservation failed. User action is needed.</td><td>50013</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="callbacks-about-one-off-and-agreement">Callbacks about one-off and Agreement<a href="#callbacks-about-one-off-and-agreement" class="hash-link" aria-label="Direct link to Callbacks about one-off and Agreement" title="Direct link to Callbacks about one-off and Agreement">​</a></h3><p>You will get callbacks about the payment to your callback address. Moreover, you will get callbacks about the agreement to either success or failure URL, that you have set upon agreement creation. However, unless a one-off payment automatic reservation fails, you will not get callbacks for either, before their status changes. So you should expect a callback when the agreement is <em>accepted</em> / <em>rejected</em> / <em>expired</em> and a callback when the OneOff is either <code>accepted</code>/<code>rejected</code>/<code>expired</code>. If the one-off payment&#x27;s automatic reservation fails, then the status of the one-off payment will not change, but a callback about the event will be sent.</p><p>The response for agreement creation, on the other hand, consists of both agreement and OneOff.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">One-off callback body example</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;agreement_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;8380f9e4-10a6-4f6d-b2f4-cdb7f80a4d7f&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;payment_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;022a08d8-73c6-4393-aeda-d0c8ae5172a5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;amount&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;19.45&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;currency&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DKK&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;payment_date&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2019-09-18&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Reserved&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;status_text&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Payment successfully reserved.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;status_code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;external_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3280100&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;payment_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OneOff&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="user-notifications">User notifications<a href="#user-notifications" class="hash-link" aria-label="Direct link to User notifications" title="Direct link to User notifications">​</a></h2><table><thead><tr><th>Description</th><th>When</th><th>Text</th><th>Buttons</th><th>Depends on these Notification settings</th><th>Type</th></tr></thead><tbody><tr><td><strong>Dual Device only:</strong> One-off payment on existing agreement</td><td>When a customer is purchasing on the existing agreement.</td><td>Godkend betaling på <em>Amount</em> <em>Currency</em> til <em>Merchant</em></td><td><strong>Text</strong>: Vis <strong>Navigation</strong>: Payment Overview</td><td>OS, App</td><td>OneOff</td></tr><tr><td>One-off without swipe</td><td>When One-off without swipe/confirmation was successful</td><td>Betalt <em>Amount</em> <em>Currency</em> til <em>Merchant Name</em></td><td><strong>Text</strong>: Vis <strong>Navigation</strong>:  Reservation receipt or Success receipt</td><td>OS, App</td><td>One-off</td></tr><tr><td>One-off without swipe/confirmation was <strong>NOT</strong> successful</td><td>When One-off without swipe/confirmation was NOT successful</td><td>Vi kunne ikke gennemføre din betaling til <em>Merchant</em></td><td><strong>Text</strong>: Vis <strong>Navigation</strong>:  One-off confirmation screen</td><td>OS, App</td><td>One-off</td></tr></tbody></table><p>If the user has turned off Push Notifications, then the only way the user can see the payment is by opening the activity list or agreement payments.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-off-payment-state-diagram">One-off payment state diagram<a href="#one-off-payment-state-diagram" class="hash-link" aria-label="Direct link to One-off payment state diagram" title="Direct link to One-off payment state diagram">​</a></h2><p><img loading="lazy" alt="OneOff state diagram" src="/assets/images/subs-One-Off-state-diagram1-32f3fc7c67bd4cf87cf3d0571887070d.png" width="720" height="445" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="capture-reserved-one-off-payment">Capture Reserved One-Off Payment<a href="#capture-reserved-one-off-payment" class="hash-link" aria-label="Direct link to Capture Reserved One-Off Payment" title="Direct link to Capture Reserved One-Off Payment">​</a></h2><p>When you receive a callback about a successfully reserved payment, now it&#x27;s time to capture your money. You can do that by making a call to <code>POST /api/providers/{providerId}/agreements/{agreementId}/oneoffpayments/{paymentId}/capture</code> endpoint. If the HTTP response is <code>204 - No Content</code>, it means that the money was transferred to your account.</p><p>You can capture a payment only once for an order, and the payment can&#x27;t be more than the order&#x27;s authorized amount. This means that your customers can&#x27;t add to an existing order. If they want to add more products after an order has been placed, then they need to make a new order.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cancel-one-off-payment-requestreservation">Cancel One-Off Payment Request/Reservation<a href="#cancel-one-off-payment-requestreservation" class="hash-link" aria-label="Direct link to Cancel One-Off Payment Request/Reservation" title="Direct link to Cancel One-Off Payment Request/Reservation">​</a></h2><p>In case you weren&#x27;t able to deliver goods or any other problem occurs, you can always cancel a one-off payment until it&#x27;s not captured or expired. You can do that by making a call to <code>DELETE /api/providers/{providerId}/agreements/{agreementId}/oneoffpayments/{paymentId}</code> endpoint. If the HTTP response is &#x27;204 - No Content&#x27;, it means that a one-off payment request/reservation was canceled.</p><p>The end-user cannot cancel the agreement with a pending payment reservation, only the merchant can do so.</p><p>By canceling the agreement with a pending payment reservation, then the merchant also automatically cancels the reservation</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="expired-one-off">Expired One-off<a href="#expired-one-off" class="hash-link" aria-label="Direct link to Expired One-off" title="Direct link to Expired One-off">​</a></h2><p>It is <strong>mandatory</strong> for the merchant to Capture or Cancel a one-off payment if it was reserved on a customer account.</p><p>We encourage you to capture as soon as a service is rendered or an order is shipped. It results in a bad end-user experience if the amount is reserved on the customer’s account for too long, as the customer can see the amount on their bank statement.</p><p>Uncaptured one-off payments expire after 6 days 23 hours 45 minutes.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/subscriptions/subscriptions-payments"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Subscriptions Payments</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/subscriptions/refund"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Refund</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#flow-1--one-off-payment-with-a-new-agreement" class="table-of-contents__link toc-highlight">Flow 1- One-off Payment With a New Agreement</a></li><li><a href="#flow-2---one-off-payment-on-an-existing-agreement" class="table-of-contents__link toc-highlight">Flow 2 - One-off Payment on an Existing Agreement</a></li><li><a href="#flow-3---one-off-with-auto-reserve" class="table-of-contents__link toc-highlight">Flow 3 - One-off with Auto reserve</a></li><li><a href="#one-off-payment-screens" class="table-of-contents__link toc-highlight">One-off payment screens</a></li><li><a href="#dual-device" class="table-of-contents__link toc-highlight">Dual Device</a></li><li><a href="#callbacks" class="table-of-contents__link toc-highlight">Callbacks</a><ul><li><a href="#callbacks-about-one-off-and-agreement" class="table-of-contents__link toc-highlight">Callbacks about one-off and Agreement</a></li></ul></li><li><a href="#user-notifications" class="table-of-contents__link toc-highlight">User notifications</a></li><li><a href="#one-off-payment-state-diagram" class="table-of-contents__link toc-highlight">One-off payment state diagram</a></li><li><a href="#capture-reserved-one-off-payment" class="table-of-contents__link toc-highlight">Capture Reserved One-Off Payment</a></li><li><a href="#cancel-one-off-payment-requestreservation" class="table-of-contents__link toc-highlight">Cancel One-Off Payment Request/Reservation</a></li><li><a href="#expired-one-off" class="table-of-contents__link toc-highlight">Expired One-off</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 MobilePay. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.92d7fe27.js"></script>
<script src="/assets/js/main.7b80158d.js"></script>
</body>
</html>