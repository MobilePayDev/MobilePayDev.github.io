<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-subscriptions/agreement" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Agreements | MobilePay Developer</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://developer.mobilepay.dk/docs/subscriptions/agreement"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Agreements | MobilePay Developer"><meta data-rh="true" name="description" content="An agreement is used to provide subscription service to sell to Customers."><meta data-rh="true" property="og:description" content="An agreement is used to provide subscription service to sell to Customers."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://developer.mobilepay.dk/docs/subscriptions/agreement"><link data-rh="true" rel="alternate" href="https://developer.mobilepay.dk/docs/subscriptions/agreement" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer.mobilepay.dk/docs/subscriptions/agreement" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-206187508-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/assets/css/styles.913a1e15.css">
<link rel="preload" href="/assets/js/runtime~main.d5e30a21.js" as="script">
<link rel="preload" href="/assets/js/main.ba9dcf5a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-blue.svg" alt="MobilePay" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-white.svg" alt="MobilePay" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Developer</b></a><a class="navbar__item navbar__link" href="/docs/app-payments">App Payments</a><a class="navbar__item navbar__link" href="/docs/invoice">Invoice</a><a class="navbar__item navbar__link" href="/docs/online">Online</a><a class="navbar__item navbar__link" href="/docs/pos">Point of Sale</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/subscriptions">Subscriptions</a><a class="navbar__item navbar__link" href="/docs/reporting">Reporting</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">API references</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/api/app-payments">App payments</a></li><li><a class="dropdown__link" href="/api/wehooks">Webhooks</a></li><li><a class="dropdown__link" href="/api/invoice">Invoice</a></li><li><a class="dropdown__link" href="/api/online">Online</a></li><li><a class="dropdown__link" href="/api/pos">PoS</a></li><li><a class="dropdown__link" href="/api/subscriptions">Subscriptions</a></li><li><a class="dropdown__link" href="/api/reporting">Reporting (v3)</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/support">Support</a><a href="https://github.com/MobilePayDev/MobilePayDev.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/app-payments">App Payments</a><button aria-label="Toggle the collapsible sidebar category &#x27;App Payments&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/invoice">Invoice</a><button aria-label="Toggle the collapsible sidebar category &#x27;Invoice&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/online">Online</a><button aria-label="Toggle the collapsible sidebar category &#x27;Online&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/pos">Point of Sale</a><button aria-label="Toggle the collapsible sidebar category &#x27;Point of Sale&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/subscriptions">Subscriptions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Subscriptions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/subscriptions/development-guide">Development Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/subscriptions/authentication">Authentication</a><button aria-label="Toggle the collapsible sidebar category &#x27;Authentication&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/general-notes">General notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/subscriptions-providers">Subscriptions Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/subscriptions/agreement">Agreements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/subscriptions-payments">Subscriptions Payments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/one-off-payments">One-off Payments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/refund">Refund</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/invoice">Invoice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/release-notes">Release Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/glossary">Glossary of Terms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/api-principles">API principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/transition-to-one-platform">💙🧡 Preparation for facade period</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/subscriptions/resources">Migration info 🔗</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reporting">Reporting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reporting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/support">Developer Support</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Support&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/subscriptions"><span itemprop="name">Subscriptions</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Agreements</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Agreements</h1><p>An agreement is used to provide subscription service to sell to Customers.</p><p>MobilePay Subscriptions is a flexible service, that allows merchants to tailor the user experience to their needs by using normal agreements, agreements with an initial one-off payment, agreements with a period where the price is lower than usual, and existing agreements where the customer wants to buy an add-on.</p><p>Once the user is given to choose the payment method on the merchant&#x27;s signup flow, an &quot;<em>Pay with MobilePay</em>&quot; button should be shown for the user to be able to click on. The MobilePay button must adhere to our branding guidelines <a href="https://www.mobilepaygroup.com/design" target="_blank" rel="noopener noreferrer">here</a>.  When a user clicks on this button, the merchant&#x27;s back-end system must call the <code>POST /api/providers/{providerId}/agreements</code> endpoint in order to create a <em>Pending</em> Subscription <strong>Agreement</strong>, which can only be activated by the MobilePay user through the app. After agreement confirmation, the user is redirected to the merchant success page, and the Merchant logo is shown under Active Agreements in the MobilePay app.  If the user did not manage to confirm the agreement, the customer sees a timeout screen if they are on a dual device. If they are on the app, nothing is displayed.</p><p>When the user has accepted the agreement in the MobilePay app, then the Merchant can charge Subscription payments <code>POST /api/providers/{providerId}/paymentrequests</code> and One-Off payments <code>POST /api/providers/{providerId}/agreements/{agreementId}/oneoffpayments</code>.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-agreement-request">Create agreement request<a href="#create-agreement-request" class="hash-link" aria-label="Direct link to Create agreement request" title="Direct link to Create agreement request">​</a></h2><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Create agreement request</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;external_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AGGR00068&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;amount&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;currency&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DKK&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Monthly subscription&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;frequency&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;links&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user-redirect&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;success-callback&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cancel-callback&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cancel-redirect&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://example.com/1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;country_code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DK&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;plan&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Basic&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expiration_timeout_minutes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;mobile_phone_number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4511100118&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;retention_period_hours&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;disable_notification_management&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;notifications_on&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>mobile_phone_number</code> is not required. Neither for agreement creation, or one-off creation. If you choose to add it, the phone number will be prefilled on our landing page. This means that the user will not have to type the phone number on the landing page, which makes it more convenient and time-saving for the user. We cannot enclose any phone number updates (if any) to the Merchant. We do not notify the merchant if the prefilled number was used / not used.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cancel-redirect">Cancel-redirect<a href="#cancel-redirect" class="hash-link" aria-label="Direct link to Cancel-redirect" title="Direct link to Cancel-redirect">​</a></h3><p><code>cancel-redirect</code>makes it possible for customers to cancel the agreement in the merchant&#x27;s own environment, and the merchant gets more flexibility in terms of retention strategies for their possible leaving customers.</p><p>The cancel-redirect is not mandatory, since the Merchant should only use cancel-redirect if they have a self-service environment, where a cancel or unsubscribe button is visible. The Merchant should ensure that the customer can easily cancel the agreement in their own self-service environment. To ensure the best customer experience, a clear &quot;Unsubscribe&quot; or &quot;Cancel&quot; button should be present on the merchant&#x27;s website.  </p><p>The <code>cancel-redirect</code>is a link to a website, where the customer can manage the agreement: Change, pause, cancel, etc. MobilePay does not offer any form of agreement management, like changing subscription types or prices, temporary address changes, etc. The URL is opened in the standard web browser.
The integrator must implement such functionality for the customer to manage the agreement in their system.  When a user notifies the merchant that they want to cancel a subscription or service, the merchant must ensure that the status of the agreement is set to canceled at a suitable time. However, if the customer wants to pause the agreement, then we highly recommend that you update the parameter <code>description</code> so the customer knows what the status of the payment is.  Furthermore, we highly recommend that you send a receipt to the customer via email or SMS, so they are sure that the agreement change has been established.</p><p><strong>How is this implemented?</strong>
For new agreements, use endpoint <code>POST /api/providers/{providerId}/agreements</code> with cancel-redirect link. A new link allows agreements to be canceled in merchant&#x27;s own environment. Merchants should ensure easy access to information and support.
For existing agreements: use endpoint <code>PATCH /api/providers/{providerId}/agreements{agreementId}</code>   endpoint to change agreement request parameters</p><p>The <em>Pending</em> <strong>Agreement</strong>, if not activated, will expire within the value, provided in the <code>expiration_timeout_minutes</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="request-parameters-for-create-agreement-request">Request parameters for Create agreement request<a href="#request-parameters-for-create-agreement-request" class="hash-link" aria-label="Direct link to Request parameters for Create agreement request" title="Direct link to Request parameters for Create agreement request">​</a></h3><p>Please note: You should consider which parameter in the table below should be used. Not all parameters are required, but the user will see <strong>amount</strong>, <strong>plan</strong> and <strong>description</strong> in the Agreement screen, if you choose to use those parameters. For example: if you have a campaign where the subscription is cheaper in the beginning, users will be confused by how it appears in the MobilePay app, as it might look like the full price period starts immediately if you enter the full price in <strong>amount</strong>  </p><table><thead><tr><th>Parameter</th><th>Type</th><th>Required</th><th>Description</th><th>Valid values</th></tr></thead><tbody><tr><td><strong>amount</strong></td><td>number(0.00)</td><td></td><td><strong>Agreement</strong>  amount, which will be displayed on the  <strong>Agreement</strong>  creation screen and on the  <strong>Agreement</strong>  details screen .</td><td>&gt;= 0.00, decimals separated with a dot.</td></tr><tr><td><strong>currency</strong></td><td>string(3)</td><td>required</td><td>The  <strong>Agreement</strong>  currency code, that will be displayed for the use in the MobilePay app. Currency and country_code must match a valid pair of: DKK-&gt;DK, EUR-&gt;FI.</td><td>DKK, EUR</td></tr><tr><td><strong>country_code</strong></td><td>string(2)</td><td>required</td><td>Country code, which will be used to differentiate between MobilePay DK and FI apps.</td><td>DK, FI</td></tr><tr><td><strong>plan</strong></td><td>string(30)</td><td>required</td><td>Short  <strong>Agreement</strong>  information text, that will be displayed on the  <strong>Agreement</strong>  screen in the app. (examples: &quot;Basic&quot; / &quot;Premium&quot;).</td><td></td></tr><tr><td><strong>description</strong></td><td>string(60)</td><td></td><td>Additional information provided by the merchant to the user, that will be displayed on the  <strong>Agreement</strong>  screen in the app.</td><td></td></tr><tr><td><strong>frequency</strong></td><td>int</td><td></td><td>Frequency of <strong>Payment Requests</strong>. This value will be used to divide the amount of days in a year to get a frequency in days (e.g. 365 / 12 = 30.4 - approx. every month, 365 - daily and 0 -flexible.). If you don&#x27;t fill out the frequency, the default value will be Flexible, which will be displayed for the user in the MobilePay app</td><td>1, 2, 4, 12, 26, 52, 365, 0</td></tr><tr><td><strong>external_id</strong></td><td>string</td><td></td><td><strong>Agreement</strong>  identifier that the merchants and integrators create, that identifies the user. It will be displayed for the user in the MobilePay app.  When the user sends an e-mail from the app, the external_id is in the subject field. external_id will be included in the request body of the success / cancel callback. The external_id should be unique to the agreement, and we recommend that the external_id for the agreement is the equivalent users&#x27; customer number or customer ID on the merchant side. Two different agreements should not have the same external_id</td><td>MinLength 1. MaxLength 64</td></tr><tr><td><strong>expiration_timeout_minutes</strong></td><td>int</td><td>required</td><td>Agreement expiration timeout in minutes.</td><td>Min: 1, max: 181440 (18 weeks)</td></tr><tr><td><strong>mobile_phone_number</strong></td><td>string</td><td></td><td>User&#x27;s phone number. Used to prefill user data in dual device agreement signing flow in the landing page.</td><td>Standard phone number format:  45xxxxxxxx</td></tr><tr><td><strong>retention_period_hours</strong></td><td>int</td><td></td><td>Before the retention period has passed User will not be able to Cancel an agreement</td><td>Min: 0(default), max: 24 hours</td></tr><tr><td><strong>disable_notification_management</strong></td><td>boolean</td><td></td><td>If true user will not be presented with the notification parameter, therefore will not be able to enable notifications. If false push parameter will be visible in signed agreements and push will be turned on by default. Parameter controls just push message which is sent 1 day in advance before recurring payment execution.*</td><td>Default <strong>false</strong></td></tr><tr><td><strong>notifications_on</strong></td><td>boolean</td><td></td><td>If true notifications will be turned on by default for the agreement. If <strong>disable_notification_management</strong> is set to true, notifications cannot be turned on. <em>This field is supported only by MobilePay app 5.0.0+</em></td><td>Default <strong>true</strong></td></tr><tr><td><strong>links</strong></td><td>string</td><td>required</td><td>Link relation of the  <strong>Agreement</strong>  creation sequence. Must contain 3 values for user redirect, success callback and cancel-callback links.</td><td></td></tr><tr><td><strong>links[].rel</strong></td><td>string</td><td>required</td><td>Link relation type</td><td>user-redirect, success-callback, cancel-callback, cancel-redirect</td></tr><tr><td><strong>links[].href</strong></td><td>string</td><td>required</td><td>Link relation hyperlink reference.</td><td>merchant&#x27;s url</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="agreements-response">Agreements response<a href="#agreements-response" class="hash-link" aria-label="Direct link to Agreements response" title="Direct link to Agreements response">​</a></h3><p>The response of <code>POST /api/providers/{providerId}/agreements</code> contains two values: a unique <em>id</em> of the newly created <em>Pending</em> <strong>Agreement</strong> and a link <em>rel</em> = <em>mobile-pay</em>.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1b08e244-4aea-4988-99d6-1bd22c6a5b2c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;links&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;rel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mobile-pay&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;href&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://&lt;mobile-pay-landing-page&gt;/?flow=agreement&amp;id=1b08e244-4aea-4988-99d6-1bd22c6a5b2c&amp;redirectUrl=https%3a%2f%2fwww.example.com%2fredirect&amp;countryCode=DK&amp;mobile=4511100118&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The <em>id</em> value can be used on the merchant&#x27;s back-end system to map a Subscription agreement with a specific user on the merchant&#x27;s side, and subsequently to create new <strong>Payment Requests</strong> on behalf of the user who confirmed the agreement in MobilePay.</li><li>The link <em>rel = mobile-pay</em> value contains the hyperlink reference address, which is structured in the following way: <em>https://<!-- -->&lt;<!-- -->mobile-pay-landing-page<!-- -->&gt;<!-- -->/?<strong>id</strong>=318a0bf9-9039-400c-b5ff-6ec717da2971&amp;<strong>countryCode</strong>=DK</em>. (The link is not accessible in the sandbox, only in production) The <em>id</em> property is of type <strong>guid</strong> and uniquely identifies the pending Subscription <strong>Agreement</strong> for the app to get the details and subsequently do an accept request. The <em>countryCode</em> property is used to differentiate between DK and FI apps.</li></ul><p>The link can be used in two ways:</p><ol><li>Redirect the user automatically using the HTTP response <strong>302</strong> or <strong>303</strong>. Once the user is redirected, the MobilePay app will be opened to activate the <em>Pending</em> <strong>Agreement</strong>. In this case, it is recommended to set the <em>expiration_timeout_minutes</em> value to 5 minutes.</li><li>E-mail the generated link to the user. Once the user clicks on the link, the MobilePay app will be opened to activate the <em>Pending</em> <strong>Agreement</strong>. In this case, it is recommended to set the <code>expiration_timeout_minutes</code> to a higher value (10080 - a week, 20160 - two weeks). Note, that the link will be valid only until the user accepts the agreement or a timeout occurs.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-existing-agreement-request">Update existing Agreement Request<a href="#update-existing-agreement-request" class="hash-link" aria-label="Direct link to Update existing Agreement Request" title="Direct link to Update existing Agreement Request">​</a></h2><p>It is the merchant&#x27;s responsibility to manage and update the agreements, and to use the API to make sure everything is in sync.</p><p>Use the <code>PATCH /api/providers/{providerId}/agreements/{agreementId}</code> endpoint to change agreement request parameters. Its request must match the rules of <a href="https://tools.ietf.org/html/rfc6902" target="_blank" rel="noopener noreferrer">RFC 6902 JSON Patch standards</a>.  </p><ul><li>Available operations: <strong>replace</strong></li><li>Available properties: <strong>amount</strong>, <strong>plan</strong>, <strong>description</strong>, <strong>frequency</strong>, <strong>external_id</strong>, <strong>success-callback</strong>, <strong>cancel-callback</strong>, <strong>cancel-redirect</strong>, <strong>disable_notification_management</strong></li></ul><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10.01&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/amount&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;op&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;replace&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example: The customer created Streaming Premium+ on started on 1 January 2021, which costs 100kr.
On the 1st of March 2021, the customer decides to upgrade to Streaming Premium+ which costs 150kr. The Merchant should then update <strong>amount</strong> and <strong>plan</strong> parameters to reflect those changes.  </p><p>Setting <strong>disable_notification_management</strong> to <strong>true</strong> will disable notification management and turn off notifications for the agreement.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="agreement-signing-in-dual-device-flow">Agreement signing in dual device flow<a href="#agreement-signing-in-dual-device-flow" class="hash-link" aria-label="Direct link to Agreement signing in dual device flow" title="Direct link to Agreement signing in dual device flow">​</a></h2><p><a target="_blank" href="/assets/files/subs_agreement_dual_device_flow-3fa7b878dafaa54cee3b16b5639ab3dc.jpeg"><img loading="lazy" alt="Dual device flow" src="/assets/images/subs_agreement_dual_device_flow-3fa7b878dafaa54cee3b16b5639ab3dc.jpeg" width="13504" height="4368" class="img_ev3q"></a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="agreement-signing-in-single-device-flow">Agreement signing in single device flow<a href="#agreement-signing-in-single-device-flow" class="hash-link" aria-label="Direct link to Agreement signing in single device flow" title="Direct link to Agreement signing in single device flow">​</a></h2><p><a target="_blank" href="/assets/files/subs_single_device_flow-3527decb6d08a13f0eb185544dd664f8.jpeg"><img loading="lazy" alt="Single device flow" src="/assets/images/subs_single_device_flow-3527decb6d08a13f0eb185544dd664f8.jpeg" width="6094" height="2657" class="img_ev3q"></a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="agreement-screen-with-and-without-amount-parameter">Agreement screen with and without amount parameter<a href="#agreement-screen-with-and-without-amount-parameter" class="hash-link" aria-label="Direct link to Agreement screen with and without amount parameter" title="Direct link to Agreement screen with and without amount parameter">​</a></h2><p><a target="_blank" href="/assets/files/subs-Agreement_screen_variations-cb2e68f8391c0cc972cb15954220a935.jpeg"><img loading="lazy" alt="Agreement screen" src="/assets/images/subs-Agreement_screen_variations-cb2e68f8391c0cc972cb15954220a935.jpeg" width="9368" height="5230" class="img_ev3q"></a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="translations-of-text-in-the-confirmation-checkbox">Translations of text in the confirmation checkbox<a href="#translations-of-text-in-the-confirmation-checkbox" class="hash-link" aria-label="Direct link to Translations of text in the confirmation checkbox" title="Direct link to Translations of text in the confirmation checkbox">​</a></h3><table><thead><tr><th>Language</th><th>Translation</th></tr></thead><tbody><tr><td>EN</td><td><strong>Yes, I have read the terms of the payment agreement with the merchant</strong> <br>The payment agreement allows the merchant to charge you with MobilePay if you use their service. For further info, see the terms of the merchant.</td></tr><tr><td>FI</td><td><strong>Kyllä, olen lukenut kauppiaan kanssa tehdyn maksusopimuksen ehdot</strong><br>Maksusopimus antaa kauppiaalle mahdollisuuden veloittaa sinua MobilePayn kautta, jos käytät heidän palveluaan. Katso lisätietoja kauppiaan ehdoista.</td></tr><tr><td>DK</td><td><strong>Ja, jeg har læst betingelserne for betalingsaftalen hos virksomheden</strong><br>Betalingsaftalen giver virksomheden mulighed for at opkræve dig med MobilePay, når du bruger deres service. For yderligere info, se virksomhedens betingelser.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="existing-deleted-agreement">Existing Deleted agreement<a href="#existing-deleted-agreement" class="hash-link" aria-label="Direct link to Existing Deleted agreement" title="Direct link to Existing Deleted agreement">​</a></h2><p><a target="_blank" href="/assets/files/subs-Existing_Deleted_agreements_v3-e0b2983905cd3ccff6938b66d931690d.png"><img loading="lazy" alt="Existing deleted agreement" src="/assets/images/subs-Existing_Deleted_agreements_v3-e0b2983905cd3ccff6938b66d931690d.png" width="6638" height="3685" class="img_ev3q"></a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="agreement-screen-required-and-optional-parameters">Agreement screen required and optional parameters<a href="#agreement-screen-required-and-optional-parameters" class="hash-link" aria-label="Direct link to Agreement screen required and optional parameters" title="Direct link to Agreement screen required and optional parameters">​</a></h2><p>The purple parameters below are visible in the MobilePay app on the <strong>Agreement screen</strong> if they are used by the merchant. They are optional, and should only be used if the merchant finds that they provide informative value to the customer.</p><p><a target="_blank" href="/assets/files/subs-Requiredparametersfinal-25c6d1598c42b7880068c9f424114477.png"><img loading="lazy" alt="Required parameters" src="/assets/images/subs-Requiredparametersfinal-25c6d1598c42b7880068c9f424114477.png" width="1321" height="1117" class="img_ev3q"></a></p><table><thead><tr><th>Parameter</th><th>UX Recommendation</th></tr></thead><tbody><tr><td>amount</td><td>MobilePay recommends you include the amount, if the customer pays a fixed amount every month. However, omit this parameter if the customer pays a varied amount. <strong>Example</strong>: Netflix  charges the same amount, for example, 99kr every month. Netflix could include the amount. Whereas an electricity provider charges a varied amount, dependent on the customer&#x27;s usage of electricity. It would not make sense for the Electricity Provider to include the amount.</td></tr><tr><td>description</td><td>Additional information provided by the merchant to the user. It is up to the merchant what the information should contain, as long as it is within 60 characters</td></tr><tr><td>disable_notification_management</td><td>Merchants can set if their customers should be able to manage push notifications for an agreement or not. If the merchant chooses so (true), then the push notification is not displayed when signing a new agreement and when browsing agreement information. If the merchant leaves the parameter as false, then the push parameter will be visible in signed agreements and push will be turned on by default. Parameter controls just push message which is sent 1 day in advance before recurring payment execution.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="callbacks">Callbacks<a href="#callbacks" class="hash-link" aria-label="Direct link to Callbacks" title="Direct link to Callbacks">​</a></h2><p>When the <strong>Agreement&#x27;s</strong> status changes from <em>Pending</em> we will do a callback to the merchant&#x27;s system (see the sequence diagram below).</p><p>The table below shows possible <em>status</em>, <em>status_text</em> and <em>status_code</em> values depending on the <strong>Agreement</strong> status changes.</p><table><thead><tr><th>New Status</th><th>Condition</th><th>URL</th><th>Callback <em>status</em></th><th>Callback <em>status_text</em></th><th>Callback <em>status_code</em></th></tr></thead><tbody><tr><td>Accepted</td><td><em>User swiped to accept the Agreement</em></td><td><em>success-callback</em></td><td>Active</td><td></td><td>0</td></tr><tr><td>Rejected</td><td><em>User rejected agreement in the APP</em></td><td><em>cancel-callback</em></td><td>Rejected</td><td>Agreement rejected by user</td><td>40000</td></tr><tr><td>Expired</td><td><em>User did not do anything during the agreement timeout period.</em></td><td><em>cancel-callback</em></td><td>Expired</td><td>Pending agreement expired</td><td>40001</td></tr><tr><td>Canceled</td><td><em>User canceled an Active agreement</em></td><td><em>cancel-callback</em></td><td>Canceled</td><td>Agreement canceled by user</td><td>40002</td></tr><tr><td>Canceled</td><td><em>Merchant canceled an Active or Pending agreement</em></td><td><em>cancel-callback</em></td><td>Canceled</td><td>Agreement canceled by merchant</td><td>40003</td></tr><tr><td>Canceled</td><td><em>System canceled an Active agreement because user was Deleted</em></td><td><em>cancel-callback</em></td><td>Canceled</td><td>Agreement canceled by system</td><td>40004</td></tr></tbody></table><p>You do not get a callback that tells you specifically if/when the user closes the landing page with the timer.</p><p>If there should be a pause in an agreement, like a temporary stop of a subscription: Simply do not create any charges during the pause.  You might want to update the <strong>description</strong> field of the agreement so the user can see that the subscription is paused in MobilePay. The endpoint <code>DELETE /api/providers/{providerId}/agreements/{agreementId}</code> will cancel the agreement, so we recommend that the merchant only uses that endpoint if the customer clearly notifies the merchant that they want to cancel a subscription or service. Canceled agreements can not be reactivated.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="agreement-state-diagram">Agreement state diagram<a href="#agreement-state-diagram" class="hash-link" aria-label="Direct link to Agreement state diagram" title="Direct link to Agreement state diagram">​</a></h3><p><img loading="lazy" alt="Agreement state diagram" src="/assets/images/subs-RecurringPayments_AgreementStateDiagram2final-94589dd6c5e34f2e119d50283ce4518f.png" width="928" height="541" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-callback-properties">Other callback properties<a href="#other-callback-properties" class="hash-link" aria-label="Direct link to Other callback properties" title="Direct link to Other callback properties">​</a></h3><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Format</th></tr></thead><tbody><tr><td><strong>agreement_id</strong></td><td>guid</td><td>Subscription agreement ID on the MobilePay side.</td><td></td></tr><tr><td><strong>external_id</strong></td><td>string</td><td>Agreement ID on the merchant&#x27;s side</td><td></td></tr><tr><td><strong>timestamp</strong></td><td>datetime</td><td>Timestamp when the status change occurred.</td><td>ISO 8601 UTC date and time format: YYYY-MM-DDThh:mm:ssZ</td></tr></tbody></table><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Agreement callback request example</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;agreement_id&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;63679ab7-cc49-4f75-80a7-86217fc105ea&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Canceled&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;status_text&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Canceled by user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;status_code&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;external_id&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SF0000568&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2020-01-01T12:34:56+00:00&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="user-redirect">User-redirect<a href="#user-redirect" class="hash-link" aria-label="Direct link to User-redirect" title="Direct link to User-redirect">​</a></h2><p>When the <strong>Agreement</strong> activation is complete or canceled, the user will be navigated to the link <em>rel = user-redirect</em> to finalize the signup.
Please ensure that your usage of user-redirect is well implemented on the merchant side. When the Agreement activation is completed or canceled, the user will be navigated to the link rel = user-redirect to finalize the signup.</p><p><em>rel = user-redirect</em>  should be a webpage, that awaits the callbacks and then takes appropriate action, depending on if the agreement was accepted or not. Based on the callback, you will redirect the user to the right place. Most merchants navigate the customer to a self-service overview, where the agreement is pending, and once the merchant receives the callback, then the merchant can update the status. Most merchants have a general page, that says “Thank you for your order/support”, and then it informs about the next step. It is triggered immediately after purchase, letting customers know that their order and agreement have been received and created</p><p>Merchants can add their internal order ID to the <em>rel = user-redirect</em>  when they create the agreement. For example <a href="https://www.merchantwebsite.com/ourcallback?order_id=internal" target="_blank" rel="noopener noreferrer">https://www.merchantwebsite.com/ourcallback?order_id=internal</a> order id here
This way, the merchant knows, which order the <em>rel = user-redirect</em>  should handle. It is therefore a prerequisite that the merchant has an internal order ID on their side. By including the internal order ID to the <em>rel = user-redirect</em>, the merchant also has a backup solution, in case the end customer is using incognito, as incognito makes session management, tracking, and cookie storage more complex. The <em>rel = user-redirect</em> does not need to be whitelisted by MobilePay.</p><p>Please note:  user-redirect is primarily for the visual user experience. The merchant should be aware of the fact that the user might close the browser,  the internet might fail, etc. There are cases where the user and browser interrupt the flow, and MobilePay can&#x27;t control these cases.</p><p> MobilePay doesn&#x27;t do logging on the user-redirect, since part of the data is in the app and part of the data is in the landing page, hence it would be a very complicated setup. ​ All proper data communication and logging and monitoring should be done through callbacks and GET calls.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sequence-diagram">sequence diagram<a href="#sequence-diagram" class="hash-link" aria-label="Direct link to sequence diagram" title="Direct link to sequence diagram">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="agreement-creation">Agreement creation<a href="#agreement-creation" class="hash-link" aria-label="Direct link to Agreement creation" title="Direct link to Agreement creation">​</a></h4><p><img loading="lazy" alt="Create agreement" src="/assets/images/subs-CreateAgreementV2-2df6da8d731c5dda242c4429c21adb33.png" width="1021" height="811" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="when-the-merchant-cancels-an-agreement">When the merchant cancels an agreement<a href="#when-the-merchant-cancels-an-agreement" class="hash-link" aria-label="Direct link to When the merchant cancels an agreement" title="Direct link to When the merchant cancels an agreement">​</a></h4><p><img loading="lazy" alt="Cancel agreement merchant" src="/assets/images/subs-CancelAgreement_Merchant-1a69d85d651a9a7892f8284a2a00299a.png" width="844" height="319" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="when-the-user-cancels-a-pending-agreement-during-signup">When the user cancels a Pending agreement during signup<a href="#when-the-user-cancels-a-pending-agreement-during-signup" class="hash-link" aria-label="Direct link to When the user cancels a Pending agreement during signup" title="Direct link to When the user cancels a Pending agreement during signup">​</a></h4><p><img loading="lazy" alt="Cancel agreement user signup" src="/assets/images/subs-CancelAgreement_User_Signup-6f4447a39aae8703678dcff0dbaa8ddf.png" width="851" height="240" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="when-the-user-cancels-an-active-agreement">When the user cancels an Active agreement<a href="#when-the-user-cancels-an-active-agreement" class="hash-link" aria-label="Direct link to When the user cancels an Active agreement" title="Direct link to When the user cancels an Active agreement">​</a></h4><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>If <code>cancel-redirect</code>url is set on an agreement, then this flow is not relevant, because agreement cancellation is not possible in the MobilePay app.</p></div></div><p><img loading="lazy" alt="Cancel agreement" src="/assets/images/subs-CancelAgreement_User-70f457c3e099d815729f819bd7462dc1.png" width="752" height="320" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/subscriptions/subscriptions-providers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Subscriptions Providers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/subscriptions/subscriptions-payments"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Subscriptions Payments</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-agreement-request" class="table-of-contents__link toc-highlight">Create agreement request</a><ul><li><a href="#cancel-redirect" class="table-of-contents__link toc-highlight">Cancel-redirect</a></li><li><a href="#request-parameters-for-create-agreement-request" class="table-of-contents__link toc-highlight">Request parameters for Create agreement request</a></li><li><a href="#agreements-response" class="table-of-contents__link toc-highlight">Agreements response</a></li></ul></li><li><a href="#update-existing-agreement-request" class="table-of-contents__link toc-highlight">Update existing Agreement Request</a></li><li><a href="#agreement-signing-in-dual-device-flow" class="table-of-contents__link toc-highlight">Agreement signing in dual device flow</a></li><li><a href="#agreement-signing-in-single-device-flow" class="table-of-contents__link toc-highlight">Agreement signing in single device flow</a></li><li><a href="#agreement-screen-with-and-without-amount-parameter" class="table-of-contents__link toc-highlight">Agreement screen with and without amount parameter</a><ul><li><a href="#translations-of-text-in-the-confirmation-checkbox" class="table-of-contents__link toc-highlight">Translations of text in the confirmation checkbox</a></li></ul></li><li><a href="#existing-deleted-agreement" class="table-of-contents__link toc-highlight">Existing Deleted agreement</a></li><li><a href="#agreement-screen-required-and-optional-parameters" class="table-of-contents__link toc-highlight">Agreement screen required and optional parameters</a></li><li><a href="#callbacks" class="table-of-contents__link toc-highlight">Callbacks</a><ul><li><a href="#agreement-state-diagram" class="table-of-contents__link toc-highlight">Agreement state diagram</a></li><li><a href="#other-callback-properties" class="table-of-contents__link toc-highlight">Other callback properties</a></li></ul></li><li><a href="#user-redirect" class="table-of-contents__link toc-highlight">User-redirect</a><ul><li><a href="#sequence-diagram" class="table-of-contents__link toc-highlight">sequence diagram</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 MobilePay. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d5e30a21.js"></script>
<script src="/assets/js/main.ba9dcf5a.js"></script>
</body>
</html>