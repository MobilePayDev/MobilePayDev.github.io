"use strict";(self.webpackChunkmobile_pay_merchant_payments_documentation=self.webpackChunkmobile_pay_merchant_payments_documentation||[]).push([[6984],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>m});var i=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),s=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=s(e.components);return i.createElement(l.Provider,{value:t},e.children)},d="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},h=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=s(n),h=a,m=d["".concat(l,".").concat(h)]||d[h]||f[h]||o;return n?i.createElement(m,r(r({ref:t},p),{},{components:n})):i.createElement(m,r({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=h;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c[d]="string"==typeof e?e:a,r[1]=c;for(var s=2;s<o;s++)r[s]=n[s];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}h.displayName="MDXCreateElement"},38846:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>f,frontMatter:()=>o,metadata:()=>c,toc:()=>s});var i=n(58168),a=(n(96540),n(15680));const o={sidebar_position:6},r="Notification Service",c={unversionedId:"pos/notification-service",id:"pos/notification-service",title:"Notification Service",description:"Clients that are unable to detect whether a customer has checked in by user activation can use the notification service. To be able to use the notification service, the integrator needs to implement an endpoint that MobilePay will call, when a client should query the active check-in on a PoS.",source:"@site/docs/pos/notification-service.md",sourceDirName:"pos",slug:"/pos/notification-service",permalink:"/docs/pos/notification-service",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"docsSidebar",previous:{title:"Point-of-Sale Management",permalink:"/docs/pos/pos-management"},next:{title:"Best Practices",permalink:"/docs/pos/best-practices"}},l={},s=[{value:"Notification endpoint",id:"notification-endpoint",level:2},{value:"Migrating to a different notification endpoint",id:"migrating-to-a-different-notification-endpoint",level:2}],p={toc:s},d="wrapper";function f(e){let{components:t,...n}=e;return(0,a.yg)(d,(0,i.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"notification-service"},"Notification Service"),(0,a.yg)("p",null,"Clients that are unable to detect whether a customer has checked in by ",(0,a.yg)("a",{parentName:"p",href:"/docs/pos/detecting-mobilepay#user-activation"},"user activation")," can use the notification service. To be able to use the notification service, the integrator needs to implement an endpoint that MobilePay will call, when a client should query the active check-in on a PoS."),(0,a.yg)("p",null,"When the endpoint is implemented the URL has to be communicated to MobilePay in order to validate and whitelist it in the firewalls. This is done by sending an email to ",(0,a.yg)("a",{parentName:"p",href:"mailto:developer@vippsmobilepay.com"},"developer@vippsmobilepay.com"),". When the URL is whitelisted the integrator will receive a reference to that URL called a ",(0,a.yg)("inlineCode",{parentName:"p"},"CallbackAlias"),". The client will use this alias when ",(0,a.yg)("a",{parentName:"p",href:"/docs/pos/pos-management#pos-creation"},"creating a PoS")," to indicate which notification endpoint to call."),(0,a.yg)("h2",{id:"notification-endpoint"},"Notification endpoint"),(0,a.yg)("p",null,"The requirements for a notification endpoint are as follows:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"It must be an HTTPS POST endpoint."),(0,a.yg)("li",{parentName:"ul"},"It must accept a JSON body that has the following format:  ")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},'{\n  "MerchantId"          : "622d3369-f940-4921-93eb-c8fca0c081b4",\n  "MerchantBrandId"     : "MPPOS12345",\n  "MerchantLocationId"  : "12345",\n  "MerchantPosId"       : "MobilePay Merchant Pos Id"\n  "PosId"               : "7e6acbde-345e-4641-b2f4-d8df0f3a5147"\n}\n')),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"The format of the different fields can be found ",(0,a.yg)("a",{parentName:"p",href:"/docs/pos/input-and-output-formats"},"here"),".")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("p",{parentName:"li"},"The notification endpoint must respond with status code ",(0,a.yg)("inlineCode",{parentName:"p"},"200 OK")," when the notification is processed successfully. The MobilePay notification service will retry notification calls in case of any other response than ",(0,a.yg)("inlineCode",{parentName:"p"},"200 OK"),". The service will retry the call 3 times."))),(0,a.yg)("h2",{id:"migrating-to-a-different-notification-endpoint"},"Migrating to a different notification endpoint"),(0,a.yg)("p",null,"In case an existing PoS has to be migrated to use a different notification, the integrator will have to contact MobilePay by writing an email to ",(0,a.yg)("a",{parentName:"p",href:"mailto:developer@vippsmobilepay.com"},"developer@vippsmobilepay.com")," asking for the change. The new URL will have to go through validation and whitelisting as described above.\nThis included changing the mapping between the URL and the existing ",(0,a.yg)("inlineCode",{parentName:"p"},"CallbackAlias"),". Close collaboration on the time of switching the URL is important to make sure the new endpoint is ready to receive notifications at the time of the change."))}f.isMDXComponent=!0}}]);