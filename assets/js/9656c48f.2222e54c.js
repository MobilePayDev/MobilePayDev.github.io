"use strict";(self.webpackChunkmobile_pay_merchant_payments_documentation=self.webpackChunkmobile_pay_merchant_payments_documentation||[]).push([[1986],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||i;return n?r.createElement(h,o(o({ref:t},p),{},{components:n})):r.createElement(h,o({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},63822:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var r=n(87462),a=(n(67294),n(3905));const i={sidebar_position:3},o="General notes",s={unversionedId:"subscriptions/general-notes",id:"subscriptions/general-notes",title:"General notes",description:"Billing your customers has never been easier before. This document explains how to make a technical integration to the MobilePay Subscription API. The audience for this document is either technical integrators acting on behalf of merchants or merchants themselves.",source:"@site/docs/subscriptions/general-notes.md",sourceDirName:"subscriptions",slug:"/subscriptions/general-notes",permalink:"/docs/subscriptions/general-notes",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docsSidebar",previous:{title:"Refresh tokens",permalink:"/docs/subscriptions/authentication/open-id/refresh-tokens"},next:{title:"Subscriptions Providers",permalink:"/docs/subscriptions/subscriptions-providers"}},l={},c=[{value:"REST request correlation",id:"rest-request-correlation",level:2},{value:"REST callback authentication",id:"rest-callback-authentication",level:2},{value:"REST callback retries",id:"rest-callback-retries",level:2},{value:"Merchant onboarding",id:"merchant-onboarding",level:2}],p={toc:c};function u(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"general-notes"},"General notes"),(0,a.kt)("p",null,"Billing your customers has never been easier before. This document explains how to make a technical integration to the MobilePay Subscription API. The audience for this document is either technical integrators acting on behalf of merchants or merchants themselves."),(0,a.kt)("p",null,"Our MobilePay Subscriptions REST API enables you to:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Establish and manage ",(0,a.kt)("strong",{parentName:"li"},"Agreements")," between you, the ",(0,a.kt)("strong",{parentName:"li"},"Merchant"),", and MobilePay ",(0,a.kt)("strong",{parentName:"li"},"Users"),"."),(0,a.kt)("li",{parentName:"ol"},"Create ",(0,a.kt)("strong",{parentName:"li"},"Subscription Payments")," in relation to an established ",(0,a.kt)("strong",{parentName:"li"},"Agreement")," and get notified about the status via REST callbacks. ",(0,a.kt)("strong",{parentName:"li"},"Subscription Payments")," are requested 1 day before the actual booking date - no manual user confirmation is required!")),(0,a.kt)("p",null,"This document does not include detailed specifications of the endpoints, responses, and response codes. This information can be found in the API section of the Developer Portal."),(0,a.kt)("p",null,"MobilePay Subscriptions is a full-fledged HTTPS REST API using JSON as request/response communication media.\nAll dates and time stamps use the ISO 8601 format: date format - ",(0,a.kt)("inlineCode",{parentName:"p"},"YYYY-MM-DD"),", date-time format - ",(0,a.kt)("inlineCode",{parentName:"p"},"YYYY-MM-DDTHH:mm:ssZ"),".\nAmounts are enclosed in double quotation marks using ",(0,a.kt)("inlineCode",{parentName:"p"},"0.00")," format, decimals separated with a dot.\nWhen doing ",(0,a.kt)("inlineCode",{parentName:"p"},"POST"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"PATCH")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"PUT")," requests, ",(0,a.kt)("inlineCode",{parentName:"p"},"Content-Type: application/json")," HTTP header must be provided."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"curl --request POST --header 'Content-Type: application/json' --url https://<mobile-pay-root>/resource --data '{}'\n")),(0,a.kt)("h2",{id:"rest-request-correlation"},"REST request correlation"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"CorrelationId")," is an optional ",(0,a.kt)("em",{parentName:"p"},(0,a.kt)("a",{parentName:"em",href:"https://en.wikipedia.org/wiki/Globally_unique_identifier"},"Guid"))," header value that can be used to link requests on your back-end system to MobilePay Subscriptions business transaction for more convenient debugging."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"curl --header 'CorrelationId: 37b8450b-579b-489d-8698-c7800c65934c' --url https://<mobile-pay-root>/api/merchants/me/agreements\n")),(0,a.kt)("h2",{id:"rest-callback-authentication"},"REST callback authentication"),(0,a.kt)("p",null,"Use one of these endpoints to set the REST callback authentication scheme and credentials:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"PUT /api/providers/{providerId}/auth/oauth2")," - set OAuth2 scheme which conforms to RFC 6749 ",(0,a.kt)("a",{parentName:"li",href:"https://tools.ietf.org/html/rfc6749#section-4.4"},"section 4.4."),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"PUT /api/providers/{providerId}/auth/basic")," - set Basic auth scheme using username and password."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"PUT /api/providers/{providerId}/auth/apikey")," - set a value which will be set to the ",(0,a.kt)("em",{parentName:"li"},"Authorization")," header. The API key must conform to the token68 specification as defined in RFC 7235 ",(0,a.kt)("a",{parentName:"li",href:"https://tools.ietf.org/html/rfc7235#section-2.1"},"section2.1."),".")),(0,a.kt)("h2",{id:"rest-callback-retries"},"REST callback retries"),(0,a.kt)("p",null,"Once the payment or agreement changes state, a callback will be done to the callback address, which is configurable via ",(0,a.kt)("inlineCode",{parentName:"p"},"PATCH /api/providers/{providerId}")," with path value ",(0,a.kt)("inlineCode",{parentName:"p"},"/payment_status_callback_url"),". Note that callbacks can only be delivered using ports 80 and 443."),(0,a.kt)("p",null,"In case the REST callback failed, 8 retries will be made using the ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Exponential_backoff"},"exponential back-off algorithm"),", where N - next retry time, c - retry attempt number, R - second retry time in seconds (1st retry is an exception and is done after 5 seconds):"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Exponential backoff",src:n(67596).Z,width:"127",height:"18"})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"1st retry \u2013 5 seconds"),(0,a.kt)("li",{parentName:"ul"},"2nd retry \u2013 10 minutes after 1st retry"),(0,a.kt)("li",{parentName:"ul"},"3rd retry \u2013 30 minutes after 2nd retry"),(0,a.kt)("li",{parentName:"ul"},"4th retry \u2013 1h 10 minutes after 3rd retry"),(0,a.kt)("li",{parentName:"ul"},"5th retry \u2013 2h 30 minutes after 4th retry"),(0,a.kt)("li",{parentName:"ul"},"6th retry \u2013 5h 10 minutes after 5th retry"),(0,a.kt)("li",{parentName:"ul"},"7th retry \u2013 10h 30 minutes after 6th retry"),(0,a.kt)("li",{parentName:"ul"},"8th retry \u2013 21h 10 minutes after 7th retry")),(0,a.kt)("h2",{id:"merchant-onboarding"},"Merchant onboarding"),(0,a.kt)("p",null,"You enroll in the Subscriptions Production via ",(0,a.kt)("a",{parentName:"p",href:"https://mobilepay.dk/da-dk/Pages/mobilepay.aspx"},"www.MobilePay.dk")," or the MobilePay Administration portal. Then you get access to the MobilePay Sandbox environment, where you can test the API.  "),(0,a.kt)("p",null,"Once you sign up, you'll receive a welcome email containing everything you need to get going right away. While we encourage you to start exploring our API right away, we highly recommend getting in touch with us at ",(0,a.kt)("a",{parentName:"p",href:"mailto:developer@vippsmobilepay.com"},"developer@vippsmobilepay.com")," before you go too far down your integration path. MobilePay has dedicated technical resources available to help you plan and build the right integration, avoid pitfalls, and get live as quickly as possible."))}u.isMDXComponent=!0},67596:(e,t,n)=>{n.d(t,{Z:()=>r});const r="data:image/gif;base64,R0lGODlhfwASAOMAAP///wAAAO7u7nZ2djIyMszMzFRUVERERKqqqmZmZrq6uhAQEIiIiJiYmNzc3CIiIiH5BAEAAAAALAAAAAB/ABIAAAT+EMhJq704611F42CofWJpnlgicEzDFGgoJJYwEAEsCUZwIDHM4BEYGBMqE0NBcSUOTIkBOIgGJ4KDboIgVRAHQ4V2xRzIksHCRGiuAI4AsPAoVxyDRsA6aVsQCAFvAAJAdhZyFIFbHF0UD1sGdQ1ohxN7Fi0VCisLDFyDlgAKARWSJQcOFAteA6UKYoSMZZgVBQcVJGoTn6ITNxRPoRxrGacAAy1eh7UVxRMkcVG9vgAEUw0GBKomzzWJ1RTN4l8TB7gOfGMG7O3uAxo5EwmxFnSzcHVm1OES4xMPBnGaQMrBMlGkFJW6UGCBunwYGPDbcOucxYsTxT0EEBCas2SE/YDNWyhCgDcuGfv9k+DtIANPGui5mwkPw4OaEgjoK3FylJeUolYCeFbgoAChZY7yIYBuoxluEgokUEAVQaVwK29JSLDgwcGrh274MDSKQIODG86uCsCWbT1fNg4EIDCAEQOy/fJSyKI3hp++gJHhC5xBAVrC4cAirqF4MdzDjiU0GBQBADs="}}]);