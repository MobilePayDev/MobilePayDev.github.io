"use strict";(self.webpackChunkmobile_pay_merchant_payments_documentation=self.webpackChunkmobile_pay_merchant_payments_documentation||[]).push([[5981],{15680:(e,t,n)=>{n.d(t,{xA:()=>m,yg:()=>h});var a=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),l=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},m=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},c="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),c=l(n),d=r,h=c["".concat(p,".").concat(d)]||c[d]||y[d]||o;return n?a.createElement(h,s(s({ref:t},m),{},{components:n})):a.createElement(h,s({ref:t},m))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[c]="string"==typeof e?e:r,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},85045:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>y,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var a=n(58168),r=(n(96540),n(15680));const o={sidebar_position:1},s="Payment Flow",i={unversionedId:"pos/payment-flows/payment-flow",id:"pos/payment-flows/payment-flow",title:"Payment Flow",description:"The payment flow makes the payment ready for customer approval immediately upon creation. The sequence diagram below illustrates a sunshine scenario for a payment flow.",source:"@site/docs/pos/payment-flows/payment-flow.md",sourceDirName:"pos/payment-flows",slug:"/pos/payment-flows/payment-flow",permalink:"/docs/pos/payment-flows/payment-flow",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docsSidebar",previous:{title:"Payment overview",permalink:"/docs/pos/payment-flows/"},next:{title:"Prepared Payment Flow",permalink:"/docs/pos/payment-flows/prepared-payment-flow"}},p={},l=[{value:"Payment States for the Payment Flow",id:"payment-states-for-the-payment-flow",level:2}],m={toc:l},c="wrapper";function y(e){let{components:t,...o}=e;return(0,r.yg)(c,(0,a.A)({},m,o,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"payment-flow"},"Payment Flow"),(0,r.yg)("p",null,"The payment flow makes the payment ready for customer approval immediately upon creation. The sequence diagram below illustrates a sunshine scenario for a payment flow."),(0,r.yg)("p",null,"The customer checks in on the PoS and receives information about the store on his device. Then, the client initiates a payment on the PoS which is immediately ready for approval and issued to the customer. The payment is now in the ",(0,r.yg)("em",{parentName:"p"},"IssuedToUser")," state and will remain there until the customer accepts the payment and the payment amount has been reserved. At that point the payment will transition to the ",(0,r.yg)("em",{parentName:"p"},"Reserved")," state. In this state, the payment can be cancelled or captured by the client resulting in the payment state transitioning to either the ",(0,r.yg)("em",{parentName:"p"},"Cancelled")," or ",(0,r.yg)("em",{parentName:"p"},"Captured")," state, respectively."),(0,r.yg)("p",null,(0,r.yg)("a",{target:"_blank",href:n(20264).A},(0,r.yg)("img",{alt:"PaymentAfterCheckIn",src:n(48846).A,width:"1739",height:"1444"}))),(0,r.yg)("p",null,"It is also possible to initiate a payment on a PoS without an active check-in, as shown in the sequence diagram below. In this case the payment state starts out as ",(0,r.yg)("em",{parentName:"p"},"Initiated")," and remains in that state until a customer is paired with the payment through a check-in. At that point the payment request is immediately issued to the customer and the state of the payment transitions to ",(0,r.yg)("em",{parentName:"p"},"IssuedToUser"),". The rest of the flow proceeds in the same way as the scenario above."),(0,r.yg)("p",null,(0,r.yg)("a",{target:"_blank",href:n(1477).A},(0,r.yg)("img",{alt:"PaymentBeforeCheckIn",src:n(73599).A,width:"1847",height:"1886"}))),(0,r.yg)("h2",{id:"payment-states-for-the-payment-flow"},"Payment States for the Payment Flow"),(0,r.yg)("p",null,"The diagram below shows all the possible states and transitions for a Payment flow. A payment can be cancelled by the customer until the customer has accepted the payment and the payment amount has been reserved. A payment can be cancelled by the client until it is captured or expires. After a payment has been captured, it can be ",(0,r.yg)("a",{parentName:"p",href:"#refunds"},"refunded"),", but can no longer be cancelled. A payment expires if it is neither cancelled nor captured within the lifetime of the reservation which is 7 days. If a payment expires, the state transitions to ",(0,r.yg)("em",{parentName:"p"},"ExpiredAndCancelled"),".\nA payment in the ",(0,r.yg)("em",{parentName:"p"},"Initiated")," or ",(0,r.yg)("em",{parentName:"p"},"IssuedToUser")," state can also be cancelled by MobilePay if it has been inactive for too long or an error occurs while reserving the payment amount on the customer's card or account. If a payment is\ncancelled by MobilePay the state transitions to ",(0,r.yg)("em",{parentName:"p"},"CancelledByMobilePay"),". The Payment states ",(0,r.yg)("em",{parentName:"p"},"Initiated")," and ",(0,r.yg)("em",{parentName:"p"},"IssuedToUser")," are called ",(0,r.yg)("em",{parentName:"p"},"active")," states and will block further payments on the same Point-of-Sale."),(0,r.yg)("img",{src:n(286).A,alt:"PoS confirmation screen",width:"700"}))}y.isMDXComponent=!0},20264:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/files/pos-PaymentFlow-PaymentAfterCheckIn-b6595b1e7e7038261bec547d7c963ae8.png"},1477:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/files/pos-PaymentFlow-PaymentBeforeCheckIn-5ee97569da979ee55ef06041d918ac5d.png"},286:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/pos-payment-states-117f28ed14e51eabe217e3aa79503852.png"},48846:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/pos-PaymentFlow-PaymentAfterCheckIn-b6595b1e7e7038261bec547d7c963ae8.png"},73599:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/pos-PaymentFlow-PaymentBeforeCheckIn-5ee97569da979ee55ef06041d918ac5d.png"}}]);